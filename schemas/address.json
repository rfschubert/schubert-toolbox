{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://schemas.schubert-toolbox.com/address.json",
  "title": "Address Schema",
  "description": "ISO 19160 compliant address schema with international support",
  "type": "object",
  "properties": {
    "id": {
      "type": "string",
      "format": "uuid",
      "description": "Unique identifier for the address"
    },
    "street_number": {
      "type": ["string", "null"],
      "description": "Street number"
    },
    "street_name": {
      "type": ["string", "null"],
      "description": "Street name"
    },
    "street_type": {
      "type": ["string", "null"],
      "description": "Street type (e.g., Street, Avenue, Road)"
    },
    "unit": {
      "type": ["string", "null"],
      "description": "Apartment, suite, unit number"
    },
    "building": {
      "type": ["string", "null"],
      "description": "Building name or number"
    },
    "floor": {
      "type": ["string", "null"],
      "description": "Floor number"
    },
    "neighborhood": {
      "type": ["string", "null"],
      "description": "District, suburb, neighborhood"
    },
    "locality": {
      "type": ["string", "null"],
      "description": "City, town, village"
    },
    "sublocality": {
      "type": ["string", "null"],
      "description": "Sub-city area"
    },
    "administrative_area_1": {
      "type": ["string", "null"],
      "description": "State, province, region"
    },
    "administrative_area_2": {
      "type": ["string", "null"],
      "description": "County, district"
    },
    "administrative_area_3": {
      "type": ["string", "null"],
      "description": "Sub-district"
    },
    "postal_code": {
      "type": ["string", "null"],
      "description": "Postal code"
    },
    "postal_code_suffix": {
      "type": ["string", "null"],
      "description": "Postal code suffix"
    },
    "country": {
      "$ref": "#/definitions/Country"
    },
    "address_type": {
      "type": "string",
      "enum": ["residential", "business", "mailing", "billing", "shipping", "temporary", "previous"],
      "default": "residential",
      "description": "Type of address"
    },
    "status": {
      "type": "string",
      "enum": ["active", "inactive", "pending_verification", "verified", "invalid"],
      "default": "active",
      "description": "Address status"
    },
    "coordinates": {
      "$ref": "#/definitions/GeographicCoordinates"
    },
    "components": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/AddressComponent"
      },
      "description": "Flexible address components for country-specific formats"
    },
    "formatted_address": {
      "type": ["string", "null"],
      "description": "Human-readable formatted address"
    },
    "formatted_address_local": {
      "type": ["string", "null"],
      "description": "Local language formatted address"
    },
    "is_verified": {
      "type": "boolean",
      "default": false,
      "description": "Whether the address has been verified"
    },
    "verified_at": {
      "type": ["string", "null"],
      "format": "date-time",
      "description": "When the address was verified"
    },
    "verification_source": {
      "type": ["string", "null"],
      "description": "Source of address verification"
    },
    "is_primary": {
      "type": "boolean",
      "default": false,
      "description": "Whether this is the primary address"
    },
    "is_default": {
      "type": "boolean",
      "default": false,
      "description": "Whether this is the default address"
    },
    "priority": {
      "type": "integer",
      "minimum": 0,
      "default": 0,
      "description": "Priority order for address selection"
    },
    "created_at": {
      "type": "string",
      "format": "date-time"
    },
    "updated_at": {
      "type": ["string", "null"],
      "format": "date-time"
    },
    "metadata": {
      "type": "object",
      "additionalProperties": true
    }
  },
  "anyOf": [
    {
      "required": ["street_name"]
    },
    {
      "required": ["locality"]
    },
    {
      "required": ["formatted_address"]
    }
  ],
  "definitions": {
    "Country": {
      "type": ["object", "null"],
      "properties": {
        "code": {
          "type": ["string", "null"],
          "pattern": "^[A-Z]{2}$",
          "description": "ISO 3166-1 alpha-2 country code"
        },
        "alpha3": {
          "type": ["string", "null"],
          "pattern": "^[A-Z]{3}$",
          "description": "ISO 3166-1 alpha-3 country code"
        },
        "numeric": {
          "type": ["string", "null"],
          "pattern": "^[0-9]{3}$",
          "description": "ISO 3166-1 numeric country code"
        },
        "name": {
          "type": ["string", "null"],
          "description": "Country name in English"
        },
        "local_name": {
          "type": ["string", "null"],
          "description": "Country name in local language"
        }
      }
    },
    "GeographicCoordinates": {
      "type": ["object", "null"],
      "properties": {
        "latitude": {
          "type": "number",
          "minimum": -90,
          "maximum": 90,
          "description": "Latitude coordinate"
        },
        "longitude": {
          "type": "number",
          "minimum": -180,
          "maximum": 180,
          "description": "Longitude coordinate"
        },
        "accuracy": {
          "type": ["string", "null"],
          "description": "Accuracy level (e.g., rooftop, street, city)"
        },
        "source": {
          "type": ["string", "null"],
          "description": "Source of coordinates (e.g., google, manual)"
        }
      },
      "required": ["latitude", "longitude"]
    },
    "AddressComponent": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "description": "Component type (e.g., street_number, route, locality)"
        },
        "value": {
          "type": "string",
          "description": "Component value"
        },
        "short_name": {
          "type": ["string", "null"],
          "description": "Short name for the component"
        },
        "long_name": {
          "type": ["string", "null"],
          "description": "Long name for the component"
        }
      },
      "required": ["type", "value"]
    }
  }
}
